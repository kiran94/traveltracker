function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:{lat:51.5331414,lng:-.4773218},scrollwheel:!1,zoom:12})}function addMarker(a,b){var c=new google.maps.Marker({title:a,position:b,map:map,animation:google.maps.Animation.DROP});markers.push(c)}function clearMarkers(){if(markers=[]){for(var a=0;a<markers.length;a++)markers[a].setMap(null);markers.length=0}}function GeneratePolyline(a){return new google.maps.Polyline({path:a,geodesic:!0,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2})}function GetTripLocations(){var a=document.getElementById("currentTrip").innerHTML;$.ajax({url:"GetLocations.php",type:"POST",data:{TripID:a},dataType:"json",success:function(a,b,c){clearMarkers();var d=[],e=new google.maps.LatLngBounds;a.forEach(function(a){var b={lat:parseFloat(a.Lat),lng:parseFloat(a.Long)};addMarker(a.Name,b),d.push(b),e.extend(new google.maps.LatLng(b.lat,b.lng))},this);var f=GeneratePolyline(d);f.setMap(map),map.setCenter(e.getCenter()),map.fitBounds(e)},error:function(a,b,c){console.log("error "+b)}})}function registerGetLocationButton(){$("#location").on("click",function(a){a.preventDefault(),loader=$("#loader"),loader.css("display","block"),getLocation()})}function getLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(SetLocation):(document.getElementById("lat_label").innerHTML="Error",document.getElementById("lng_label").innerHTML="Error")}function SetLocation(a){lat.val(a.coords.latitude),document.getElementById("lat_label").innerHTML="Lat: "+a.coords.latitude,lng.val(a.coords.longitude),document.getElementById("lng_label").innerHTML="Long: "+a.coords.longitude,loader.css("display","none")}var map,markers=[];$(document).ready(function(){GetTripLocations(),$(".trip").on("click",function(){document.getElementById("currentTrip").innerHTML=$(this).attr("id"),GetTripLocations()})});var loader,lat=$("#lat"),lng=$("#lng");$(document).ready(function(){registerGetLocationButton()});